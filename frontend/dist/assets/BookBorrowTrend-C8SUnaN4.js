var a=(a,t,e)=>new Promise(((s,r)=>{var i=a=>{try{o(e.next(a))}catch(t){r(t)}},n=a=>{try{o(e.throw(a))}catch(t){r(t)}},o=a=>a.done?s(a.value):Promise.resolve(a.value).then(i,n);o((e=e.apply(a,t)).next())}));import{L as t}from"./index-Bqf32_B1.js";import{g as e,_ as s}from"./index-Co7Jc6td.js";import{u as r}from"./useChart-CfybhMev.js";import{g as i}from"./libraryStatsApi-BDD51Fcp.js";import{k as n,r as o,w as l,e as c,m,t as u,z as d,I as p,J as v,G as y}from"./vendor-CJD3O2Jl.js";const g={class:"card art-custom-card book-borrow-trend-card"},f={class:"content-container"},x={class:"chart-wrapper"},b={class:"stats-list"},h={class:"num"},k={class:"name"},w=s(n({__name:"BookBorrowTrend",setup(s){const{chartRef:n,isDark:w,initChart:A,getAxisLineStyle:L,getAxisLabelStyle:B,getAxisTickStyle:C,getSplitLineStyle:D}=r(),S=o([{name:"总借阅量",num:"--"},{name:"在借图书",num:"--"},{name:"日均借阅",num:"--"},{name:"归还率",num:"--"}]),j=["周一","周二","周三","周四","周五","周六","周日"],_=o([0,0,0,0,0,0,0]),E=()=>a(this,null,(function*(){var a,t,e,s;const r=yield i();if(200===r.code&&r.data){S.value=[{name:"总借阅量",num:`${null!=(a=r.data.totalBorrowCount)?a:"--"}`},{name:"在借图书",num:`${null!=(t=r.data.currentBorrowingCount)?t:"--"}`},{name:"日均借阅",num:`${null!=(e=r.data.lastWeekAvgBorrow)?e:"--"}`},{name:"归还率",num:`${null!=(s=r.data.lastWeekReturnRate)?s:"--"}`}];const i=r.data.lastWeekBorrowCountPerDay||{},n=Object.keys(i).sort();_.value=n.slice(0,7).map((a=>i[a]))}})),R=()=>({grid:{top:15,right:0,bottom:0,left:0,containLabel:!0},tooltip:{trigger:"item"},xAxis:{type:"category",data:j,axisTick:C(),axisLine:L(!0),axisLabel:B(!0)},yAxis:{axisLabel:B(!0),axisLine:L(!w.value),splitLine:D(!0)},series:[{data:_.value,type:"bar",itemStyle:{borderRadius:4,color:new t(0,0,0,1,[{offset:0,color:e("--el-color-primary-light-4")},{offset:1,color:e("--el-color-primary")}])},barWidth:"50%",animationDelay:a=>50*a+300,animationDuration:a=>1500-50*a,animationEasing:"quarticOut"}]});return l(w,(()=>{A(R())})),c((()=>a(this,null,(function*(){yield E(),A(R())})))),(a,t)=>(u(),m("div",g,[d("div",f,[d("div",x,[t[0]||(t[0]=d("div",{class:"text"},[d("h3",{class:"box-title"},"借阅趋势"),d("p",{class:"subtitle"},"显示了图书馆近期的借阅量变化趋势，帮助了解读者活跃度")],-1)),d("div",{class:"chart",ref_key:"chartRef",ref:n},null,512)]),d("div",b,[(u(!0),m(p,null,v(S.value,((a,t)=>(u(),m("div",{key:t,class:"stat-item"},[d("p",h,y(a.num),1),d("p",k,y(a.name),1)])))),128))])]),t[1]||(t[1]=d("div",{class:"image-container"},[d("img",{src:"/assets/%E5%8D%A1%E6%8F%90%E8%A5%BF%E4%BA%9A-CX5IDvWd.png",alt:"文学少女",class:"trend-bg-image",loading:"lazy"})],-1))]))}}),[["__scopeId","data-v-b27d92ba"]]);export{w as default};
