var e=Object.defineProperty,a=Object.defineProperties,l=Object.getOwnPropertyDescriptors,t=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable,u=(a,l,t)=>l in a?e(a,l,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[l]=t,n=(e,a)=>{for(var l in a||(a={}))o.call(a,l)&&u(e,l,a[l]);if(t)for(var l of t(a))r.call(a,l)&&u(e,l,a[l]);return e},i=(e,a,l)=>new Promise(((t,o)=>{var r=e=>{try{n(l.next(e))}catch(a){o(a)}},u=e=>{try{n(l.throw(e))}catch(a){o(a)}},n=e=>e.done?t(e.value):Promise.resolve(e.value).then(r,u);n((l=l.apply(e,a)).next())}));import{_ as s}from"./ArtTableFullScreen-BwfyNbV_.js";import{r as d,b as p,D as m,I as c,F as f,_ as b}from"./index-D1Hg0Vwf.js";/* empty css                */import{_ as h}from"./ArtIconSelector-gougTIW9.js";/* empty css               *//* empty css               *//* empty css                       *//* empty css                        */import{_ as v}from"./ArtTable-BWVjlKAF.js";/* empty css                        *//* empty css                    */import{_}from"./ArtTableHeader-BD9E-x0T.js";import{u as g,_ as y}from"./useCheckedColumns-nzvmapJX.js";import{A as V}from"./ArtButtonTable-Bc-gga8r.js";import{al as k,s as j,k as w,r as C,a2 as I,e as x,c as L,D as A,S as O,t as U,y as E,z as T,x as H,i as S,u as N,a$ as P,O as B,P as M,T as D,G as q,m as R,I as F,J as z,aN as J,b0 as $,a6 as G,a3 as K,v as Z,a4 as W,aM as X,aL as Q,aJ as Y,aI as ee,L as ae,ac as le,ab as te,E as oe,n as re,_ as ue,aZ as ne,av as ie,aw as se}from"./vendor-CJD3O2Jl.js";import"./iconfont-DPUoc2h2.js";/* empty css                   *//* empty css                      *//* empty css                 */import"./formEnum-BLgiZVxV.js";import"./vue-draggable-plus-g6z8A2Qb.js";/* empty css                 *//* empty css                       */const de=p(),pe={class:"menu-page",id:"table-full-screen"},me={class:"dialog-footer"};var ce;const fe=b(w((ce=n({},{name:"Menus"}),a(ce,l({__name:"index",setup(e){const{hasAuth:a}=(()=>{var e,a;const l=k(),{isFrontendMode:t}=d(),{info:o}=j(de),r=null!=(a=null==(e=o.value)?void 0:e.buttons)?a:[],u=Array.isArray(l.meta.authList)?l.meta.authList:[];return{hasAuth:e=>t.value?r.includes(e):u.some((a=>(null==a?void 0:a.auth_mark)===e))}})(),{menuList:l}=j(m()),t=C(!1),o={name:"",route:""},r=I(n({},o)),u=I(n({},o)),p=()=>{Object.assign(r,n({},o)),Object.assign(u,n({},o)),we()},b=()=>{Object.assign(u,n({},r)),we()},w=[{label:"菜单名称",prop:"name",type:"input",config:{clearable:!0}},{label:"路由地址",prop:"route",type:"input",config:{clearable:!0}}],ce=[{label:"勾选",type:"selection"},{label:"用户名",prop:"avatar"},{label:"手机号",prop:"mobile"},{label:"性别",prop:"sex"},{label:"部门",prop:"dep"},{label:"状态",prop:"status"},{label:"创建日期",prop:"create_time"},{label:"操作",prop:"operation"}],fe=e=>{var a,l,t;return e.children&&e.children.length>0?"info":(null==(a=e.meta)?void 0:a.link)&&(null==(l=e.meta)?void 0:l.isIframe)?"success":e.path?"primary":(null==(t=e.meta)?void 0:t.link)?"warning":void 0},{columnChecks:be,columns:he}=g((()=>[{prop:"meta.title",label:"菜单名称",minWidth:120,formatter:e=>{var a;return f(null==(a=e.meta)?void 0:a.title)}},{prop:"type",label:"菜单类型",formatter:e=>ue(ne,{type:fe(e)},(()=>(e=>{var a,l,t;return e.children&&e.children.length>0?"目录":(null==(a=e.meta)?void 0:a.link)&&(null==(l=e.meta)?void 0:l.isIframe)?"内嵌":e.path?"菜单":(null==(t=e.meta)?void 0:t.link)?"外链":void 0})(e)))},{prop:"path",label:"路由",formatter:e=>{var a;return(null==(a=e.meta)?void 0:a.link)||e.path||""}},{prop:"meta.authList",label:"可操作权限",formatter:e=>{var a;return ue("div",{},null==(a=e.meta.authList)?void 0:a.map(((e,a)=>ue(ie,{placement:"top-start",title:"操作",width:200,trigger:"click",key:a},{default:()=>ue("div",{style:"margin: 0; text-align: right"},[ue(M,{size:"small",type:"primary",onClick:()=>Ee("button",e)},{default:()=>"编辑"}),ue(M,{size:"small",type:"danger",onClick:()=>Se()},{default:()=>"删除"})]),reference:()=>ue(M,{class:"small-btn"},{default:()=>e.title})}))))}},{prop:"date",label:"编辑时间",formatter:()=>"2022-3-12 12:00:00"},{prop:"status",label:"隐藏菜单",formatter:e=>ue(ne,{type:e.meta.isHide?"danger":"info"},(()=>e.meta.isHide?"是":"否"))},{prop:"operation",label:"操作",width:180,formatter:e=>ue("div",[a("B_CODE1")&&ue(V,{type:"add",onClick:()=>Ee("menu")}),a("B_CODE2")&&ue(V,{type:"edit",onClick:()=>Ae("edit",e)}),a("B_CODE3")&&ue(V,{type:"delete",onClick:()=>He()})])}])),ve=()=>{we()},_e=C(!1),ge=I({name:"",path:"",label:"",icon:"",isEnable:!0,sort:1,isMenu:!0,keepAlive:!0,isHidden:!0,link:"",isIframe:!1,authName:"",authLabel:"",authIcon:"",authSort:1}),ye=C(c.UNICODE),Ve=C("menu"),ke=I({name:[{required:!0,message:"请输入菜单名称",trigger:"blur"},{min:2,max:20,message:"长度在 2 到 20 个字符",trigger:"blur"}],path:[{required:!0,message:"请输入路由地址",trigger:"blur"}],label:[{required:!0,message:"输入权限标识",trigger:"blur"}],authName:[{required:!0,message:"请输入权限名称",trigger:"blur"}],authLabel:[{required:!0,message:"请输入权限权限标识",trigger:"blur"}]}),je=C([]);x((()=>{we()}));const we=()=>{t.value=!0,setTimeout((()=>{je.value=l.value,t.value=!1}),500)},Ce=L((()=>{const e=a=>a.filter((a=>{var l,t,o;const r=(null==(l=u.name)?void 0:l.toLowerCase().trim())||"",n=(null==(t=u.route)?void 0:t.toLowerCase().trim())||"",i=f((null==(o=a.meta)?void 0:o.title)||"").toLowerCase(),s=(a.path||"").toLowerCase(),d=!r||i.includes(r),p=!n||s.includes(n);if(a.children&&a.children.length>0){const l=e(a.children);if(l.length>0)return a.children=l,!0}return d&&p}));return e(je.value)})),Ie=C(!1),xe=C(),Le=L((()=>{const e="menu"===Ve.value?"菜单":"权限";return Ie.value?`编辑${e}`:`新建${e}`})),Ae=(e,a)=>{Ee("menu",a,!0)},Oe=()=>{},Ue=()=>i(this,null,(function*(){xe.value&&(yield xe.value.validate((e=>i(this,null,(function*(){if(e)try{Ie.value,oe.success((Ie.value?"编辑":"新增")+"成功"),_e.value=!1}catch(a){oe.error((Ie.value?"编辑":"新增")+"失败")}})))))})),Ee=(e,a,l=!1)=>{_e.value=!0,Ve.value=e,Ie.value=!1,Pe.value=l,Te(),a&&(Ie.value=!0,re((()=>{"menu"===e?(ge.name=f(a.meta.title),ge.path=a.path,ge.label=a.name,ge.icon=a.meta.icon,ge.sort=a.meta.sort||1,ge.isMenu=a.meta.isMenu,ge.keepAlive=a.meta.keepAlive,ge.isHidden=a.meta.isHidden||!0,ge.isEnable=a.meta.isEnable||!0,ge.link=a.meta.link,ge.isIframe=a.meta.isIframe||!1):(ge.authName=a.title,ge.authLabel=a.auth_mark,ge.authIcon=a.icon||"",ge.authSort=a.sort||1)})))},Te=()=>{var e;null==(e=xe.value)||e.resetFields(),Object.assign(ge,{name:"",path:"",label:"",icon:"",sort:1,isMenu:!0,keepAlive:!0,isHidden:!0,link:"",isIframe:!1,authName:"",authLabel:"",authIcon:"",authSort:1})},He=()=>i(this,null,(function*(){try{yield se.confirm("确定要删除该菜单吗？删除后无法恢复","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),oe.success("删除成功")}catch(e){"cancel"!==e&&oe.error("删除失败")}})),Se=()=>i(this,null,(function*(){try{yield se.confirm("确定要删除该权限吗？删除后无法恢复","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),oe.success("删除成功")}catch(e){"cancel"!==e&&oe.error("删除失败")}})),Ne=L((()=>!(!Ie.value||"button"!==Ve.value)||!(!Ie.value||"menu"!==Ve.value)||!(Ie.value||"menu"!==Ve.value||!Pe.value))),Pe=C(!1),Be=C(!1),Me=C(),De=()=>{Be.value=!Be.value,re((()=>{Me.value&&Me.value[Be.value?"expandAll":"collapseAll"]()}))};return(e,a)=>{const l=y,o=_,u=J,n=v,i=Q,d=X,m=W,c=ae,f=ee,g=Y,V=h,k=le,j=te,C=K,I=G,x=P,L=s,oe=A("auth"),re=A("ripple");return U(),O(L,null,{default:E((()=>[T("div",pe,[H(l,{filter:N(r),"onUpdate:filter":a[0]||(a[0]=e=>S(r)?r.value=e:null),items:w,showExpand:!1,onReset:p,onSearch:b},null,8,["filter"]),H(x,{shadow:"never",class:"art-table-card"},{default:E((()=>[H(o,{columnList:ce,showZebra:!1,columns:N(be),"onUpdate:columns":a[2]||(a[2]=e=>S(be)?be.value=e:null),onRefresh:ve},{left:E((()=>[B((U(),O(N(M),{onClick:a[1]||(a[1]=e=>Ee("menu",null,!0))},{default:E((()=>a[19]||(a[19]=[D(" 添加菜单 ")]))),_:1,__:[19]})),[[oe,"add"],[re]]),B((U(),O(N(M),{onClick:De},{default:E((()=>[D(q(N(Be)?"收起":"展开"),1)])),_:1})),[[re]])])),_:1},8,["columns"]),H(n,{rowKey:"path",ref_key:"tableRef",ref:Me,loading:N(t),data:N(Ce),marginTop:10,stripe:!1},{default:E((()=>[(U(!0),R(F,null,z(N(he),(e=>(U(),O(u,$({key:e.prop||e.type},{ref_for:!0},e),null,16)))),128))])),_:1},8,["loading","data"]),H(I,{title:N(Le),modelValue:N(_e),"onUpdate:modelValue":a[18]||(a[18]=e=>S(_e)?_e.value=e:null),width:"700px","align-center":""},{footer:E((()=>[T("span",me,[H(N(M),{onClick:a[16]||(a[16]=e=>_e.value=!1)},{default:E((()=>a[22]||(a[22]=[D("取 消")]))),_:1,__:[22]}),H(N(M),{type:"primary",onClick:a[17]||(a[17]=e=>Ue())},{default:E((()=>a[23]||(a[23]=[D("确 定")]))),_:1,__:[23]})])])),default:E((()=>[H(C,{ref_key:"formRef",ref:xe,model:N(ge),rules:N(ke),"label-width":"85px"},{default:E((()=>[H(m,{label:"菜单类型"},{default:E((()=>[H(d,{modelValue:N(Ve),"onUpdate:modelValue":a[3]||(a[3]=e=>S(Ve)?Ve.value=e:null),disabled:N(Ne)},{default:E((()=>[H(i,{value:"menu",label:"menu"},{default:E((()=>a[20]||(a[20]=[D("菜单")]))),_:1,__:[20]}),H(i,{value:"button",label:"button"},{default:E((()=>a[21]||(a[21]=[D("权限")]))),_:1,__:[21]})])),_:1},8,["modelValue","disabled"])])),_:1}),"menu"===N(Ve)?(U(),R(F,{key:0},[H(g,{gutter:20},{default:E((()=>[H(f,{span:12},{default:E((()=>[H(m,{label:"菜单名称",prop:"name"},{default:E((()=>[H(c,{modelValue:N(ge).name,"onUpdate:modelValue":a[4]||(a[4]=e=>N(ge).name=e),placeholder:"菜单名称"},null,8,["modelValue"])])),_:1})])),_:1}),H(f,{span:12},{default:E((()=>[H(m,{label:"路由地址",prop:"path"},{default:E((()=>[H(c,{modelValue:N(ge).path,"onUpdate:modelValue":a[5]||(a[5]=e=>N(ge).path=e),placeholder:"路由地址"},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),H(g,{gutter:20},{default:E((()=>[H(f,{span:12},{default:E((()=>[H(m,{label:"权限标识",prop:"label"},{default:E((()=>[H(c,{modelValue:N(ge).label,"onUpdate:modelValue":a[6]||(a[6]=e=>N(ge).label=e),placeholder:"权限标识"},null,8,["modelValue"])])),_:1})])),_:1}),H(f,{span:12},{default:E((()=>[H(m,{label:"图标",prop:"icon"},{default:E((()=>[H(V,{iconType:N(ye),defaultIcon:N(ge).icon,width:"229px"},null,8,["iconType","defaultIcon"])])),_:1})])),_:1})])),_:1}),H(g,{gutter:20},{default:E((()=>[H(f,{span:12},{default:E((()=>[H(m,{label:"菜单排序",prop:"sort",style:{width:"100%"}},{default:E((()=>[H(k,{modelValue:N(ge).sort,"onUpdate:modelValue":a[7]||(a[7]=e=>N(ge).sort=e),style:{width:"100%"},onChange:Oe,min:1,"controls-position":"right"},null,8,["modelValue"])])),_:1})])),_:1}),H(f,{span:12},{default:E((()=>[H(m,{label:"外部链接",prop:"link"},{default:E((()=>[H(c,{modelValue:N(ge).link,"onUpdate:modelValue":a[8]||(a[8]=e=>N(ge).link=e),placeholder:"外部链接/内嵌地址(https://www.baidu.com)"},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),H(g,{gutter:20},{default:E((()=>[H(f,{span:5},{default:E((()=>[H(m,{label:"是否启用",prop:"isEnable"},{default:E((()=>[H(j,{modelValue:N(ge).isEnable,"onUpdate:modelValue":a[9]||(a[9]=e=>N(ge).isEnable=e)},null,8,["modelValue"])])),_:1})])),_:1}),H(f,{span:5},{default:E((()=>[H(m,{label:"页面缓存",prop:"keepAlive"},{default:E((()=>[H(j,{modelValue:N(ge).keepAlive,"onUpdate:modelValue":a[10]||(a[10]=e=>N(ge).keepAlive=e)},null,8,["modelValue"])])),_:1})])),_:1}),H(f,{span:5},{default:E((()=>[H(m,{label:"是否显示",prop:"isHidden"},{default:E((()=>[H(j,{modelValue:N(ge).isHidden,"onUpdate:modelValue":a[11]||(a[11]=e=>N(ge).isHidden=e)},null,8,["modelValue"])])),_:1})])),_:1}),H(f,{span:5},{default:E((()=>[H(m,{label:"是否内嵌",prop:"isMenu"},{default:E((()=>[H(j,{modelValue:N(ge).isIframe,"onUpdate:modelValue":a[12]||(a[12]=e=>N(ge).isIframe=e)},null,8,["modelValue"])])),_:1})])),_:1})])),_:1})],64)):Z("",!0),"button"===N(Ve)?(U(),R(F,{key:1},[H(g,{gutter:20},{default:E((()=>[H(f,{span:12},{default:E((()=>[H(m,{label:"权限名称",prop:"authName"},{default:E((()=>[H(c,{modelValue:N(ge).authName,"onUpdate:modelValue":a[13]||(a[13]=e=>N(ge).authName=e),placeholder:"权限名称"},null,8,["modelValue"])])),_:1})])),_:1}),H(f,{span:12},{default:E((()=>[H(m,{label:"权限标识",prop:"authLabel"},{default:E((()=>[H(c,{modelValue:N(ge).authLabel,"onUpdate:modelValue":a[14]||(a[14]=e=>N(ge).authLabel=e),placeholder:"权限标识"},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),H(g,{gutter:20},{default:E((()=>[H(f,{span:12},{default:E((()=>[H(m,{label:"权限排序",prop:"authSort",style:{width:"100%"}},{default:E((()=>[H(k,{modelValue:N(ge).authSort,"onUpdate:modelValue":a[15]||(a[15]=e=>N(ge).authSort=e),style:{width:"100%"},onChange:Oe,min:1,"controls-position":"right"},null,8,["modelValue"])])),_:1})])),_:1})])),_:1})],64)):Z("",!0)])),_:1},8,["model","rules"])])),_:1},8,["title","modelValue"])])),_:1})])])),_:1})}}})))),[["__scopeId","data-v-44cbbeee"]]);export{fe as default};
